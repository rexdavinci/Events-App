(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{170:function(e,t,n){},171:function(e,t,n){},174:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(55),l=n.n(c),o=(n(65),n(14)),i=n(10),s=(n(66),n(2)),u=n.n(s),m=n(4),d=(n(68),Object(a.createContext)());var p=function(){var e=Object(a.useContext)(d).login,t=Object(a.useState)(!0),n=Object(m.a)(t,2),c=n[0],l=n[1],o=Object(a.createRef)(),i=Object(a.createRef)();return r.a.createElement("form",{className:"auth-form",onSubmit:function(t){var n,a,r,l,s,m,d,p,E;return u.a.async((function(b){for(;;)switch(b.prev=b.next){case 0:if(t.preventDefault(),n=o.current.value.trim().toLowerCase(),a=i.current.value.trim(),0!==n.length&&0!==a.length){b.next=5;break}return b.abrupt("return",null);case 5:return r={query:"\n        query Login($email: String!, $password: String!){\n          login(email: $email, password: $password){\n            id\n            email\n            loginInfo {\n              userId\n              token\n              tokenExpiration\n            }\n            events {\n              title\n              description\n              price\n              date\n            }\n            myBookings {\n              bookedEvent {\n                title\n                price\n                description\n                date\n              }\n            }\n          }\n        }\n      ",variables:{email:n,password:a}},c||(r={query:"\n          mutation CreateUser($email: String!, $password: String!) {\n            createUser(userInput: {email: $email, password: $password}){\n              id\n              email\n              loginInfo {\n                userId\n                token\n                tokenExpiration\n              }\n              events {\n                title\n                description\n                price\n                date\n              }\n              myBookings {\n                id\n                bookedEvent {\n                  title\n                  price\n                  date\n                  description\n                }\n              }\n            }\n          }\n        ",variables:{email:n,password:a}}),b.prev=7,b.next=10,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}));case 10:return l=b.sent,b.next=13,u.a.awrap(l.json());case 13:s=b.sent,m=s.data,d=m.login,p=m.createUser,s.errors&&console.log(s.errors[0].message),E=function(t){return e(t.loginInfo.token,t.id)},d&&E(d),p&&E(p),b.next=26;break;case 23:return b.prev=23,b.t0=b.catch(7),b.abrupt("return",b.t0);case 26:case"end":return b.stop()}}),null,null,[[7,23]])}},r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"email"},"E-mail:"),r.a.createElement("input",{type:"email",id:"email",ref:o})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"password"}," Password:"),r.a.createElement("input",{type:"password",id:"password",ref:i})),r.a.createElement("div",{className:"form-actions"},r.a.createElement("button",{type:"submit"}," ",c?"Login":"Signup"," "),r.a.createElement("button",{type:"button",onClick:function(){l(!c)}},"Switch to ",c?"Signup":"Login")))},E=n(18),b=(n(69),n(70),function(e){return r.a.createElement("div",{className:"modal"},r.a.createElement("header",{className:"modal__header"},r.a.createElement("h1",null,e.title)),r.a.createElement("section",{className:"modal__content"},e.children),r.a.createElement("section",{className:"modal__actions"},e.canCancel&&r.a.createElement("button",{className:"btn",onClick:e.onCancel},"Cancel"),e.canConfirm&&e.confirmText&&r.a.createElement("button",{className:"btn",onClick:e.onConfirm},e.confirmText)))}),f=(n(71),function(e){return r.a.createElement("div",{className:"backdrop"})}),v=(n(72),n(73),function(e){var t=Object(a.useContext)(d).userId;return r.a.createElement(r.a.Fragment,null,r.a.createElement("li",{key:e.eventId,className:"event__list-item"},r.a.createElement("div",null,r.a.createElement("h1",null,e.title),r.a.createElement("h2",null,"$",e.price," - ",new Date(e.date).toLocaleString()),r.a.createElement("p",null,e.time)),r.a.createElement("div",null,r.a.createElement("button",{className:"btn",onClick:function(){return e.onDetail(e.eventId)}},"View Details")),r.a.createElement("div",null,t===e.creatorId?r.a.createElement("p",null,"You are the owner of this event"):r.a.createElement("button",{className:"btn",onClick:function(){return e.onDetail(e.eventId)}},"Book Event"))))}),h=function(e){var t=e.events.map((function(t){return r.a.createElement(v,{key:t.id,eventId:t.id,title:t.title,creatorId:t.creator.id,price:t.price,date:t.date,time:t.time,onDetail:e.onViewDetail})}));return r.a.createElement("ul",{className:"event__list"},t)},k=(n(74),function(){return r.a.createElement("div",{className:"spinner"},r.a.createElement("div",{className:"lds-ellipsis"},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)))}),g=function(){var e=Object(a.useContext)(d),t=Object(a.useState)(!1),n=Object(m.a)(t,2),c=n[0],l=n[1],o=Object(a.useState)([]),i=Object(m.a)(o,2),s=i[0],p=i[1],v=Object(a.useState)(!1),g=Object(m.a)(v,2),x=g[0],O=g[1],y=Object(a.useState)(null),j=Object(m.a)(y,2),w=j[0],C=j[1],N=Object(a.createRef)(),S=Object(a.createRef)(),I=Object(a.createRef)(),_=Object(a.createRef)(),T=Object(a.createRef)(),D=function(){l(!1),C(null)};return Object(a.useEffect)((function(){!function(){var e,t,n;u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,O(!0),e={query:"\n          query {\n            events{\n              id\n              price\n              date\n              description\n              title\n              creator{\n                id\n                email\n              }\n              bookings{\n                booker{\n                  email\n                }\n              }\n            }\n          }\n        "},a.next=5,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}));case 5:if(200===(t=a.sent).status||201===t.status){a.next=8;break}throw new Error("Failed!");case 8:return a.next=10,u.a.awrap(t.json());case 10:n=a.sent,p(n.data.events),O(!1),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),O(!1);case 18:case"end":return a.stop()}}),null,null,[[0,15]])}()}),[]),r.a.createElement(r.a.Fragment,null,(c||w)&&r.a.createElement(f,null),c&&r.a.createElement(b,{confirmText:"Confirm",title:"Add Event",canConfirm:!0,canCancel:!0,onCancel:D,onConfirm:function(){var t,n,a,r,c,o,i,s;return u.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(m.prev=0,l(!1),t=N.current.value,n=+S.current.value,a=I.current.value,r=T.current.value,c=_.current.value,!(0===t.trim().length||n<=0||0===a.trim().length||0===c.trim().length||0===r.trim().length)){m.next=9;break}return m.abrupt("return",null);case 9:return o={query:'\n          mutation {\n            createEvent(eventInput:{title:"'.concat(t,'", description:"').concat(r,'", price:').concat(n,', date:"').concat(a," ").concat(c,'"}){\n              id\n              description\n              title\n              price\n              date\n              bookings {\n                booker {\n                  email\n                }\n              }\n              creator{\n                id\n                email\n                events{\n                  id\n                  title\n                  description\n                  date\n                }\n              } \n            }\n          }\n        ')},m.next=12,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}}));case 12:return i=m.sent,m.next=15,u.a.awrap(i.json());case 15:s=m.sent,p((function(e){return[].concat(Object(E.a)(e),[s.data.createEvent])})),m.next=22;break;case 19:return m.prev=19,m.t0=m.catch(0),m.abrupt("return",m.t0);case 22:case"end":return m.stop()}}),null,null,[[0,19]])}},r.a.createElement("p",null,"Modal Content"),r.a.createElement("form",null,r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"title"},"Title"),r.a.createElement("input",{type:"text",id:"title",ref:N})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"price"},"Price"),r.a.createElement("input",{type:"number",id:"price",ref:S})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"date"},"Date"),r.a.createElement("input",{type:"date",id:"date",ref:I}),r.a.createElement("input",{type:"time",id:"time",ref:_,defaultValue:"13:30"})),r.a.createElement("div",{className:"form-control"},r.a.createElement("label",{htmlFor:"description"},"Description"),r.a.createElement("textarea",{id:"description",rows:"4",ref:T})))),w&&r.a.createElement(b,{confirmText:e.token?"Book":null,title:w.title,canConfirm:!0,canCancel:!0,onCancel:D,onConfirm:function(){var t,n,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,e.token){r.next=4;break}return C(null),r.abrupt("return",null);case 4:return t={query:'\n          mutation {\n            bookEvent(eventId: "'.concat(w.id,'"){\n              createdAt\n              updatedAt\n              booker{\n                id\n                email\n                events {\n                  id\n                  description\n                  date\n                  title\n                  price\n                }\n              }\n              bookedEvent{\n                id\n                description\n                date\n                title\n                price\n                creator{\n                  id\n                  email\n                }\n              }\n            }\n          }\n        ')},r.next=7,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer "+e.token}}));case 7:return n=r.sent,r.next=10,u.a.awrap(n.json());case 10:if(!(a=r.sent).errors){r.next=13;break}throw Error(a.errors[0].message);case 13:C(null),r.next=19;break;case 16:r.prev=16,r.t0=r.catch(0),console.log(r.t0);case 19:case"end":return r.stop()}}),null,null,[[0,16]])}},r.a.createElement("h1",null,w.title),r.a.createElement("h3",null,"Date: ",new Date(w.date).toLocaleString()),r.a.createElement("p",null,"Price: ",r.a.createElement("em",null,"$",w.price)," "),r.a.createElement("p",null,"Detail:"),r.a.createElement("p",null,w.description),r.a.createElement("p",null,w.time)),e.token&&r.a.createElement("div",{className:"events-control"},r.a.createElement("p",null,"Share Your Events"),r.a.createElement("button",{className:"btn",onClick:function(){l(!0)}},"Create Event")),x?r.a.createElement(k,null):r.a.createElement(h,{events:s,onViewDetail:function(e){var t=s.find((function(t){return t.id===e}));C(t)}}))},x=function(){return r.a.createElement("h1",null,"The Home Page")},O=(n(75),function(e){return r.a.createElement("ul",{className:"bookings__list"},e.bookings.length>0?e.bookings.map((function(t){return r.a.createElement("li",{key:t.id,className:"bookings__item"},r.a.createElement("div",{className:"bookings__item-data"},r.a.createElement("small",null,"$ ",t.bookedEvent.price),t.bookedEvent.title," - "," ",new Date(t.createdAt).toLocaleString()),r.a.createElement("div",{className:"bookings__item-actions"},r.a.createElement("button",{className:"btn",onClick:function(){return e.onDelete(t.id)}},"Cancel")))})):r.a.createElement("p",null,"You have not booked any event yet"))}),y=n(56),j={Cheap:{min:0,max:100},Normal:{min:100,max:200},Expensive:{min:200,max:1e6}},w=function(e){var t={labels:[],datasets:[]},n=[],a=function(a){var r=e.bookings.reduce((function(e,t){return t.bookedEvent.price>j[a].min&&t.bookedEvent.price<j[a].max?e+1:e}),0);n.push(r),t.labels.push(a),t.datasets.push({backgroundColor:"rgb(255, 99, 132)",borderColor:"rgb(255, 99, 132)",data:Object(E.a)(n)}),(n=Object(E.a)(n))[n.length-1]=0};for(var c in j)a(c);return r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(y.a,{data:t}))},C=(n(170),function(e){return r.a.createElement("div",{className:"bookings-control"},r.a.createElement("button",{className:"list"===e.activeOutputType?"active":"",onClick:function(){return e.changeOutput("list")}},"List"),r.a.createElement("button",{className:"chart"===e.activeOutputType?"active":"",onClick:function(){return e.changeOutput("chart")}},"Chart"))}),N=function(){var e=Object(a.useState)(!1),t=Object(m.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)([]),o=Object(m.a)(l,2),i=o[0],s=o[1],p=Object(a.useState)("list"),E=Object(m.a)(p,2),b=E[0],f=E[1],v=Object(a.useContext)(d),h=Object(a.useCallback)((function(){var e,t,n;return u.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,c(!0),e={query:"\n          query {\n            bookings{\n              id\n              createdAt\n              updatedAt\n              booker{\n                id\n                events{\n                  description\n                }\n              }\n              bookedEvent{\n                id\n                title\n                date\n                price\n              }\n            }\n          }\n        "},a.next=5,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer "+v.token}}));case 5:if(200===(t=a.sent).status||201===t.status){a.next=8;break}throw new Error("Failed!");case 8:return a.next=10,u.a.awrap(t.json());case 10:n=a.sent,s(n.data.bookings),c(!1),a.next=19;break;case 15:return a.prev=15,a.t0=a.catch(0),c(!1),a.abrupt("return",a.t0);case 19:case"end":return a.stop()}}),null,null,[[0,15]])}),[v.token]);Object(a.useEffect)((function(){return h(),function(){return null}}),[h]);var g=function(e){var t,n,a;return u.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t=i.filter((function(t){return t.id!==e})),console.log(t),n={query:'\n        mutation {\n          cancelBooking(bookingId: "'.concat(e,'"){\n            title\n            creator{\n              email\n            }\n          }\n        }\n      ')},r.prev=3,r.next=6,u.a.awrap(fetch("http://localhost:5500/graphql",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Authorization:"Bearer "+v.token}}));case 6:if(200===(a=r.sent).status||201===a.status){r.next=9;break}throw new Error("Failed!");case 9:return r.next=11,u.a.awrap(a.json());case 11:s((function(t){return t.filter((function(t){return t.id!==e}))})),r.next=17;break;case 14:return r.prev=14,r.t0=r.catch(3),r.abrupt("return",r.t0);case 17:case"end":return r.stop()}}),null,null,[[3,14]])};return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",null,n?r.a.createElement(k,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(C,{changeOutput:function(e){f("list"===e?"list":"chart")},activeOutputType:b}),"list"===b?r.a.createElement(O,{bookings:i,onDelete:g}):r.a.createElement(w,{bookings:i,onDelete:g}))))},S=(n(171),function(){var e=Object(a.useContext)(d),t=e.token,n=e.logout;return r.a.createElement("header",{className:"main-navigation"},r.a.createElement("div",{className:"main-navigation__logo"},r.a.createElement("h1",null,"EasyEvent")),r.a.createElement("nav",{className:"main-navigation__items"},r.a.createElement("ul",null,!t&&r.a.createElement("li",null,r.a.createElement(o.b,{to:"/auth"},"Authenticate")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/events"},"Events")),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(o.b,{to:"/bookings"},"Bookings")),r.a.createElement("li",null,r.a.createElement("button",{onClick:n},"Logout"))))))}),I=function(){var e=Object(a.useContext)(d).token;return r.a.createElement(o.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(S,null),r.a.createElement("main",{className:"main-content"},r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/",component:x,exact:!0}),e&&r.a.createElement(i.a,{from:"/auth",to:"/events",exact:!0}),!e&&r.a.createElement(i.b,{path:"/auth",component:p}),r.a.createElement(i.b,{path:"/events",component:g}),e&&r.a.createElement(i.b,{path:"/bookings",component:N}),!e&&r.a.createElement(i.a,{from:"/bookings",to:"/events",exact:!0})))))};l.a.render(r.a.createElement((function(e){var t=e.children,n=Object(a.useState)({token:null,userId:null}),c=Object(m.a)(n,2),l=c[0],o=c[1];return r.a.createElement(d.Provider,{value:{token:l.token,userId:l.userId,login:function(e,t,n){o({token:e,userId:t})},logout:function(){o({token:null,userId:null})}}},t)}),null,r.a.createElement(I,null)),document.getElementById("root"))},60:function(e,t,n){e.exports=n(174)},65:function(e,t,n){},66:function(e,t,n){},68:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){},74:function(e,t,n){},75:function(e,t,n){}},[[60,1,2]]]);
//# sourceMappingURL=main.3d9059a1.chunk.js.map